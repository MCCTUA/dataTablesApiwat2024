<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />

    <!-- jquery -->

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <!-- datatables -->

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.datatables.net/v/bs5/jszip-3.10.1/dt-1.13.8/b-2.4.2/b-colvis-2.4.2/b-html5-2.4.2/b-print-2.4.2/r-2.5.0/datatables.min.css"
      rel="stylesheet"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/v/bs5/jszip-3.10.1/dt-1.13.8/b-2.4.2/b-colvis-2.4.2/b-html5-2.4.2/b-print-2.4.2/r-2.5.0/datatables.min.js"></script>

    <!-- google font -->

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Kanit&display=swap"
      rel="stylesheet"
    />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200")
      .material-symbols-outlined {
        font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
      }
      .centered {
        text-align: center !important;
        vertical-align: middle !important;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <table
        id="example"
        class="table table-striped nowrap centered"
        style="width: 100%"
      >
        <thead class="table-dark"></thead>
      </table>
    </div>
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        google.script.run.withSuccessHandler(showTable).getData();
      });

      function showTable(res) {
        const dataSet = res.data;
        const headers = res.headers.map((header) => {
          return { title: header };
        });
        new DataTable("#example", {
          columns: headers,
          data: dataSet,
          responsive: true,
          language: {
            url: "//cdn.datatables.net/plug-ins/1.13.7/i18n/th.json",
          },
          columnDefs: [
            { className: "centered", targets: [0, 1, 2, 3, 4, 5, 6] },
            {
              target: 6,
              render: (data) => {
                return `<a href='${data}' target=_blank> <span class="material-symbols-outlined"> download_for_offline </span> </a>`;
              },
            },
          ],
          dom: '<<"row"<"col"l><"col-md-auto"B><"col"f>>>rtip',
          buttons: [
            { extend: "copy", className: "btn-success" },
            { extend: "csv", className: "btn-primary" },
            { extend: "excel", className: "btn-danger" },
            { extend: "pdf", className: "btn-info" },
            { extend: "print", className: "btn-warning" },
          ],
          lengthMenu: [5, 10, 25, 50, 100, 200, 500, 1000],
        });
      }
    </script>
  </body>
</html>
